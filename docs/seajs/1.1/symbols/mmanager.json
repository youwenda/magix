{"isNamespace":true,"desc":"Model管理对象，可方便的对Model进行缓存和更新","alias":"MManager","methods":[{"desc":"创建Model类管理对象","alias":"MManager.create","isStatic":true,"memberOf":"MManager","isa":"FUNCTION","_name":"create","_params":[{"title":"param","desc":"Model类","type":"Model","name":"modelClass"},{"title":"param","name":"alias"}]},{"desc":"注册APP中用到的model","alias":"MManager#registerModels","memberOf":"MManager","isa":"FUNCTION","_name":"registerModels","_params":[{"title":"param","desc":"模块描述信息","type":"Object|Array","name":"models"},{"title":"param","desc":"app中model的唯一标识","type":"String","name":"models.name"},{"title":"param","desc":"传递的参数信息，如{uri:'test',isJSONP:true,updateIdent:true}","type":"Object","name":"models.options"},{"title":"param","desc":"发起请求时，默认的get参数对象","type":"Object","name":"models.urlParams"},{"title":"param","desc":"发起请求时，默认的post参数对象","type":"Object","name":"models.postParams"},{"title":"param","desc":"指定model缓存的key，当指定后，该model会进行缓存，下次不再发起请求","type":"String","name":"models.cacheKey"},{"title":"param","desc":"缓存过期时间，以毫秒为单位，当过期后，再次使用该model时会发起新的请求(前提是该model指定cacheKey被缓存后cacheTime才有效)","type":"Integer","name":"models.cacheTime"},{"title":"param","desc":"当您同时需要指定cacheKey和cacheTime时，可通过cache=true快捷指定，设置cache=true后，cacheTime默认为20分钟，您可以通过cacheTime显式控制","type":"Boolean","name":"models.cache"},{"title":"param","desc":"model在发起请求前的回调","type":"Function","name":"models.before"},{"title":"param","desc":"model在结束请求，并且成功后回调","type":"Function","name":"models.after"}]},{"desc":"注册常用方法，或以把经常几个同时请求的model封装成一个方法以便快捷调用","alias":"MManager#registerMethods","memberOf":"MManager","isa":"FUNCTION","_name":"registerMethods","_params":[{"title":"param","desc":"方法对象","type":"Object","name":"methods"}]},{"type":"Model","desc":"创建model对象","alias":"MManager#createModel","memberOf":"MManager","returns":[{"title":"return","type":"Model"}],"isa":"FUNCTION","_name":"createModel","_params":[{"title":"param","desc":"model描述信息对象","type":"Object","name":"modelAttrs"}]},{"type":"Object","desc":"获取model注册时的元信息","alias":"MManager#getModelMeta","memberOf":"MManager","returns":[{"title":"return","type":"Object"}],"exceptions":[{"title":"throws","desc":"If unfound:name","type":"Error"}],"isa":"FUNCTION","_name":"getModelMeta","_params":[{"title":"param","desc":"名称","type":"String|Object","name":"modelAttrs"}]},{"type":"Object","desc":"获取model对象，优先从缓存中获取","alias":"MManager#getModel","memberOf":"MManager","returns":[{"title":"return","type":"Object"}],"isa":"FUNCTION","_name":"getModel","_params":[{"title":"param","desc":"model描述信息对象","type":"Object","name":"modelAttrs"},{"title":"param","desc":"是否是创建新的Model对象，如果否，则尝试从缓存中获取","type":"Boolean","name":"createNew"}]},{"type":"MRequest","desc":"保存models，所有请求完成回调done","alias":"MManager#saveAll","memberOf":"MManager","returns":[{"title":"return","type":"MRequest"}],"isa":"FUNCTION","_name":"saveAll","_params":[{"title":"param","desc":"保存models时的描述信息，如:{name:'Home'urlParams:{a:'12'},postParams:{b:2}}","type":"Object|Array","name":"models"},{"title":"param","desc":"完成时的回调","type":"Function","name":"done"},{"title":"param","desc":"当传递MxView对象时，自动帮你托管MRequest","type":"MxView","name":"view","isOptional":true}]},{"type":"MRequest","desc":"获取models，所有请求完成回调done","alias":"MManager#fetchAll","memberOf":"MManager","returns":[{"title":"return","type":"MRequest"}],"isa":"FUNCTION","_name":"fetchAll","_params":[{"title":"param","desc":"获取models时的描述信息，如:{name:'Home',cacheKey:'key',urlParams:{a:'12'},postParams:{b:2}}","type":"Object|Array","name":"models"},{"title":"param","desc":"完成时的回调","type":"Function","name":"done"},{"title":"param","desc":"当传递MxView对象时，自动帮你托管MRequest","type":"MxView","name":"view","isOptional":true}],"example":[{"title":"example","desc":"\n        //定义\r\n        \r\n        define('testMM',[\"mxext/mmanager\",\"mxext/model\"],function(require){\r\n            var MM=require(\"mxext/mmanager\");\r\n            var Model=require(\"mxext/model\");\r\n        \r\n            var TestMM=MM.create(Model);\r\n            TestMM.registerModels([{\r\n                name:'Test1',\r\n                url:'/api/test1.json'\r\n            },{\r\n                name:'Test2',\r\n                url:'/api/test2.json',\r\n                urlParams:{\r\n                    type:'2'\r\n                }\r\n            }]);\r\n            return TestMM;\r\n        \r\n        });\r\n        \r\n        //使用\r\n        \r\n        seajs.use('testMM',function(TM){\r\n        \r\n            TM.fetchAll([{\r\n                name:'Test1'\r\n            },{\r\n                name:'Test2'\r\n            }],function(err,m1,m2){\r\n\r\n            });\r\n        });"}]},{"type":"MRequest","desc":"保存models，按顺序回调done","alias":"MManager#saveOrder","memberOf":"MManager","returns":[{"title":"return","type":"MRequest"}],"isa":"FUNCTION","_name":"saveOrder","_params":[{"title":"param","desc":"保存models时的描述信息，如:{name:'Home'urlParams:{a:'12'},postParams:{b:2}}","type":"Object|Array","name":"models"},{"title":"param","desc":"完成时的回调","type":"Function","name":"done"},{"title":"param","desc":"当传递MxView对象时，自动帮你托管MRequest","type":"MxView","name":"view","isOptional":true}]},{"type":"MRequest","desc":"获取models，按顺序回调done","alias":"MManager#fetchOrder","memberOf":"MManager","returns":[{"title":"return","type":"MRequest"}],"isa":"FUNCTION","_name":"fetchOrder","_params":[{"title":"param","desc":"获取models时的描述信息，如:{name:'Home',cacheKey:'key',urlParams:{a:'12'},postParams:{b:2}}","type":"Object|Array","name":"models"},{"title":"param","desc":"完成时的回调","type":"Function","name":"done"},{"title":"param","desc":"当传递MxView对象时，自动帮你托管MRequest","type":"MxView","name":"view","isOptional":true}],"example":[{"title":"example","desc":"\n        //代码片断：\r\n        //1：当按顺序获取多个model，回调只有一个时\r\n        var r=MM.fetchOrder([\r\n            {name:'M1'},\r\n            {name:'M2'},\r\n            {name:'M3'}\r\n        ],function(err,model){//回调按M1,M2,M3的顺序被调用3次\r\n            if(err){\r\n                alert(err.msg);\r\n            }else{\r\n                alert(model.get('name'));\r\n            }\r\n        });\r\n\r\n        //2:当按顺序获取多个model，回调多于一个时\r\n        var r=MM.fetchOrder([\r\n            {name:'M1'},\r\n            {name:'M2'},\r\n            {name:'M3'}\r\n        ],function(err,model){//首先被调用\r\n            if(err){\r\n                alert(err.msg);\r\n            }else{\r\n                alert(model.get('name'));\r\n            }\r\n        },function(err,model){//其次被调用\r\n            if(err){\r\n                alert(err.msg);\r\n            }else{\r\n                alert(model.get('name'));\r\n            }\r\n        });"}]},{"type":"MRequest","desc":"保存models，其中任意一个成功均立即回调，回调会被调用多次","alias":"MManager#saveOne","memberOf":"MManager","returns":[{"title":"return","type":"MRequest"}],"isa":"FUNCTION","_name":"saveOne","_params":[{"title":"param","desc":"保存models时的描述信息，如:{name:'Home',urlParams:{a:'12'},postParams:{b:2}}","type":"Object|Array","name":"models"},{"title":"param","desc":"完成时的回调","type":"Function","name":"callback"},{"title":"param","desc":"当传递MxView对象时，自动帮你托管MRequest","type":"MxView","name":"view","isOptional":true}]},{"type":"MRequest","desc":"获取models，其中任意一个成功均立即回调，回调会被调用多次","alias":"MManager#fetchOne","memberOf":"MManager","returns":[{"title":"return","type":"MRequest"}],"isa":"FUNCTION","_name":"fetchOne","_params":[{"title":"param","desc":"获取models时的描述信息，如:{name:'Home',cacheKey:'key',urlParams:{a:'12'},postParams:{b:2}}","type":"Object|Array","name":"models"},{"title":"param","desc":"完成时的回调","type":"Function","name":"callback"},{"title":"param","desc":"当传递MxView对象时，自动帮你托管MRequest","type":"MxView","name":"view","isOptional":true}],"example":[{"title":"example","desc":"\n        //代码片断：\r\n        //1：获取多个model，回调只有一个时\r\n        var r=MM.fetchOrder([\r\n            {name:'M1'},\r\n            {name:'M2'},\r\n            {name:'M3'}\r\n        ],function(err,model){//m1,m2,m3，谁快先调用谁，且被调用三次\r\n            if(err){\r\n                alert(err.msg);\r\n            }else{\r\n                alert(model.get('name'));\r\n            }\r\n        });\r\n\r\n        //2:获取多个model，回调多于一个时\r\n        var r=MM.fetchOrder([\r\n            {name:'M1'},\r\n            {name:'M2'},\r\n            {name:'M3'}\r\n        ],function(err,model){//m1什么时间返回，该回调什么时间被调用\r\n            if(err){\r\n                alert(err.msg);\r\n            }else{\r\n                alert(model.get('name'));\r\n            }\r\n        },function(err,model){//m2什么时间返回，该回调什么时间被调用\r\n            if(err){\r\n                alert(err.msg);\r\n            }else{\r\n                alert(model.get('name'));\r\n            }\r\n        });"}]},{"type":"MRequest","desc":"创建MRequest对象","alias":"MManager#createMRequest","memberOf":"MManager","returns":[{"title":"return","desc":"返回MRequest对象","type":"MRequest"}],"isa":"FUNCTION","_name":"createMRequest","_params":[{"title":"param","desc":"当传递MxView对象时，自动帮你托管MRequest","type":"MxView","name":"view","isOptional":true}]},{"desc":"根据key清除缓存的models","alias":"MManager#clearCacheByKey","memberOf":"MManager","isa":"FUNCTION","_name":"clearCacheByKey","_params":[{"title":"param","desc":"字符串","type":"String","name":"key"}]},{"desc":"根据name清除缓存的models","alias":"MManager#clearCacheByName","memberOf":"MManager","isa":"FUNCTION","_name":"clearCacheByName","_params":[{"title":"param","desc":"字符串","type":"String","name":"name"}]},{"type":"Model","desc":"从缓存中获取model对象","alias":"MManager#getCachedModel","memberOf":"MManager","returns":[{"title":"return","type":"Model"}],"isa":"FUNCTION","_name":"getCachedModel","_params":[{"title":"param","type":"String|Object","name":"modelAttrs"}]},{"type":"MManager","desc":"联合其它MManager查询","alias":"MManager#join","memberOf":"MManager","returns":[{"title":"return","type":"MManager"}],"isa":"FUNCTION","_name":"join","_params":[{"title":"param","desc":"要联合的Manager","type":"MManager","name":"manager"},{"title":"param","desc":"为联合的Manager中的元信息名称加的前缀，当2个Manager内部有同名的元信息时的解决方案","type":"String","name":"prefix","isOptional":true}],"example":[{"title":"example","desc":"//假设我们有2个Manager\rvar ReportManager=MM.create(AppModel);\rReportManager.registerModels([{\r    name:'News_List'\r    url:'report/news/list.json'\r}]);\r\rvar VideoManager=MM.create(AppModel);\rVideoManager.registerModels([{\r    name:'News_List',\r    url:'video/news/list.json'\r}]);\r\r//考虑以上2个manager同时使用的情况：我们需要体育新闻和视频新闻，我们可能会这样写：\r render:function(){\r     var me=this;\r     var r1=ReportManager.fetchAll({\r         name:'News_List'\r     },function(e,m){\r         if(!e){\r             var r2=VideoManager.fetchAll({\r                 name:'News_List'\r             },function(e,m){\r\r             });\r             me.manage(r2);\r         }\r     });\r     me.manage(r1);\r }\r\r//如上需要嵌套，而且不能同时发起请求。通过join后我们可以把2个manager合并成一个来请求：\r\rvar TempManager=ReportManager.join(VideoManager,'Video_');//因为ReportManger与VideoManager有相同的News_List,因此我们给Video的加上一个前缀Video_以示区分\rvar r=TempManager.fetchAll([{\r    name:'News_List'\r},{\r    name:'Video_News_List'\r}],function(e,reportNews,videoNews){\r\r});\rme.manage(r);"}]},{"desc":"绑定事件","alias":"MManager#on","memberOf":"MManager","isa":"FUNCTION","_name":"on","_params":[{"title":"param","desc":"事件名称","type":"String","name":"name"},{"title":"param","desc":"事件回调","type":"Function","name":"fn"},{"title":"param","desc":"事件监听插入的位置","type":"Interger","name":"insert"}],"example":[{"title":"example","desc":"var T=Magix.mix({},Event);\r\n        T.on('done',function(e){\r\n            alert(1);\r\n        });\r\n        T.on('done',function(e){\r\n            alert(2);\r\n            T.off('done',arguments.callee);\r\n        });\r\n        T.on('done',function(e){\r\n            alert(3);\r\n        },0);//监听插入到开始位置\r\n\r\n        T.once('done',function(e){\r\n            alert('once');\r\n        });\r\n\r\n        T.fire('done',{data:'test'});\r\n        T.fire('done',{data:'test2'});"}]},{"desc":"触发事件","alias":"MManager#fire","memberOf":"MManager","isa":"FUNCTION","_name":"fire","_params":[{"title":"param","desc":"事件名称","type":"String","name":"name"},{"title":"param","desc":"事件对象","type":"Object","name":"data"},{"title":"param","desc":"事件触发完成后是否移除这个事件的所有监听","type":"Boolean","name":"remove"},{"title":"param","desc":"是否从后向前触发事件的监听列表","type":"Boolean","name":"lastToFirst"}]},{"desc":"解除事件绑定","alias":"MManager#off","memberOf":"MManager","isa":"FUNCTION","_name":"off","_params":[{"title":"param","desc":"事件名称","type":"String","name":"name"},{"title":"param","desc":"事件回调","type":"Function","name":"fn"}]},{"desc":"绑定事件，触发一次后即解绑","alias":"MManager#once","memberOf":"MManager","isa":"FUNCTION","_name":"once","_params":[{"title":"param","desc":"事件名称","type":"String","name":"name"},{"title":"param","desc":"事件回调","type":"Function","name":"fn"}]}],"events":[{"desc":"创建完成Model对象后触发","alias":"MManager#event:inited","memberOf":"MManager","isEvent":true,"isa":"FUNCTION","_name":"inited","_params":[{"title":"param","type":"Object","name":"e"},{"title":"param","desc":"注册model时提供的信息","type":"Object","name":"e.meta"},{"title":"param","desc":"model对象","type":"Model","name":"e.model"}]},{"desc":"Model对象完成请求后触发","alias":"MManager#event:done","memberOf":"MManager","isEvent":true,"isa":"FUNCTION","_name":"done","_params":[{"title":"param","type":"Object","name":"e"},{"title":"param","desc":"注册model时提供的信息","type":"Object","name":"e.meta"},{"title":"param","desc":"model对象","type":"Model","name":"e.model"}]}],"isa":"CONSTRUCTOR","_name":"MManager","_params":[{"title":"param","desc":"Model类","type":"Model","name":"modelClass"}],"inherits":[{"alias":"Event.on","as":"MManager#on"},{"alias":"Event.fire","as":"MManager#fire"},{"alias":"Event.off","as":"MManager#off"},{"alias":"Event.once","as":"MManager#once"}]}